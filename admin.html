<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel</title>
    <style>
        h1{
            text-align: center;
            margin: 20px 0;
        }
        table{
            width: 90%;
        }
        thead{
            background-color: rgb(0, 119, 255);
        }
        tbody{
            background-color: rgba(4, 255, 4, 0.505);
            font-weight: bold;
        }
        tbody td button{
            background-color: rgba(255, 0, 0, 0.672);
            padding: 15px 30px;
            border-radius: 10px;
            border: 1px solid rgba(255, 0, 0, 0.375);
            color: white;
        }
    </style>
    <script>
        // Fetch orders from the server and display them
        function loadOrders() {
            fetch('get_orders.php')
                .then(response => response.json())
                .then(orders => {
                    const tableBody = document.querySelector("#ordersTable tbody");

                    // Clear existing rows
                    tableBody.innerHTML = "";

                    // Populate the table with orders
                    orders.forEach(order => {
                        const row = document.createElement("tr");
                        row.innerHTML = `
                            <td>${order.id}</td>
                            <td>${order.name}</td>
                            <td>${order.email}</td>
                            <td>${order.phone}</td>
                            <td>${order.dish_name}</td>
                            <td>${order.quantity}</td>
                            <td>${order.order_date}</td>
                            <td>
                                <button onclick="deleteOrder(${order.id})">Supprimer</button>
                            </td>
                        `;
                        tableBody.appendChild(row);
                    });
                })
                .catch(error => console.error("Error loading orders:", error));
        }

        // Delete an order
        function deleteOrder(orderId) {
            if (confirm("Are you sure you want to delete this order?")) {
                fetch(`delete_order.php?id=${orderId}`, {
                    method: 'GET',
                })
                .then(response => response.json())
                .then(result => {
                    if (result.success) {
                        alert("Order deleted successfully!");
                        loadOrders(); // Reload the table
                    } else {
                        alert("Failed to delete the order.");
                    }
                })
                .catch(error => console.error("Error deleting order:", error));
            }
        }

        // Load orders when the page is ready
        document.addEventListener("DOMContentLoaded", loadOrders);

        
    </script>
</head>
<body>
    <h1>Gestion des commandes</h1>
    <table border="1" cellpadding="10" cellspacing="0" id="ordersTable" >
        <thead>
            <tr background="green">
                <th>ID</th>
                <th>Nom de client</th>
                <th>Email</th>
                <th>Téléphone</th>
                <th>Nom du plat</th>
                <th>Quantité</th>
                <th>Date de commande</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <!-- Rows will be added dynamically -->
        </tbody>
    </table>
</body>
</html>
